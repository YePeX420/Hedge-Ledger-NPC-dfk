You are helping me build a complete user account dashboard for my Hedge Ledger Discord bot.

Context about the project:

- This is a Node.js + discord.js v14 bot.
- There is already an admin system with a /hedge-admin command and an admin web UI at /admin, using Postgres + a shared schema file (shared/schema.ts and compiled JS).
- ENV variables that already exist include:
    DISCORD_TOKEN
    DISCORD_CLIENT_ID
    DISCORD_GUILD_ID
    ADMIN_CHANNEL_ID
    OWNER_ID
    ADMIN_ROLE_ID
    ADMIN_DASHBOARD_URL
    DATABASE_URL, PGHOST, PGUSER, etc.
- Hedge is an AI NPC for DeFi Kingdoms. It will:
    - link & verify wallets
    - show LPs and APRs
    - accept 5 JEWEL payments for optimizations
    - later, automatically hold or LP funds on-chain

What I need you to build now is the **user-facing account dashboard** in Discord, via a `/account` command, plus all necessary helper files and button handlers.

Please follow these requirements carefully:

---------------------------------------------------------------------
1) Create the /account slash command
---------------------------------------------------------------------

- Create a new command file at: `commands/account.js` (or update it if it already exists).
- Use discord.js v14 and `SlashCommandBuilder`.
- Define the command as:

  - Name: `account`
  - Description: `View and manage your Hedge Ledger account.`

- The command MUST respond with an **ephemeral** message (only visible to the user).

- When executed, the command should:
  - Identify the user by `interaction.user.id` and `interaction.user.tag` (or username).
  - Call a helper function like `getOrCreateUserProfile(discordId, username)` that returns a structured object with at least:

    ```js
    {
      discordId,
      discordUsername,
      tier,              // string like "Mythic", "Legendary", "Rare", "Unranked"
      totalQueries,      // number, total Hedge queries used
      wallets: [         // list of linked wallets
        {
          id,            // unique ID (string or number)
          address,       // full wallet address
          chain,         // e.g. 'dfk-chain', 'cv', 'metis'
          verified,      // boolean
        },
        // ...
      ],
      lpPositions: [     // list of LP positions
        {
          id,            // unique ID
          poolName,      // e.g. 'CRYSTAL-JEWEL'
          chain,         // e.g. 'dfk-chain'
          lpAmount,      // number (string is fine if easier)
          apr24h,        // number or string, representing 24h effective APR including quests
        },
        // ...
      ],
      createdAt,         // Date or date string
    }
    ```

  - For now, if there is no real data from the DB or on-chain:
    - `tier` can default to `"Unranked"`
    - `totalQueries` can default to `0`
    - `wallets` can be an empty array or 1-2 mocked wallets
    - `lpPositions` can be an empty array or a couple of mocked entries
    - `createdAt` can be `new Date()` on first creation.

---------------------------------------------------------------------
2) Implement getOrCreateUserProfile helper
---------------------------------------------------------------------

- Create a new helper/service file, for example at:
  - `services/user-profile.js`
  or
  - `user-profile.js`
  (Pick a path that matches the existing project structure.)

- In this helper, implement `async function getOrCreateUserProfile(discordId, username)`:

  - Use the existing database connection / ORM pattern already used in the project (e.g., drizzle + shared/schema).
  - If there is already a `users` table in the schema, reuse it.
  - If there is no `users` table yet, create a simple table in the existing schema with at least:
    - id (primary key)
    - discordId (string, unique)
    - discordUsername (string)
    - tier (string, default 'Unranked')
    - totalQueries (integer, default 0)
    - createdAt (timestamp)
  - For wallets and LP positions:
    - If there are already tables for wallets or LPs, reuse them when populating `wallets` and `lpPositions`.
    - If not, you can:
      - Either define simple tables for them that match the data structure above, OR
      - For now, return placeholder arrays in code (we will wire the DB and DFK APIs later).

- The function should:
  - Look up a user by `discordId` in the DB.
  - If found, load their user record + wallets + LP positions into the profile object.
  - If not found, create a new user record with default values, and return a new profile object accordingly.

- Return a plain JS object; the /account command will consume it to build the embed.

---------------------------------------------------------------------
3) /account embed layout and content
---------------------------------------------------------------------

- The /account command should create an embed that looks like a personal dashboard.

- Suggested layout:

  - Title: `Your Hedge Ledger Account`
  - Description: A short explanation, for example:
    `"This is your personal Hedge Ledger dashboard. Here you can manage wallets, LPs, and paid optimizations."`

  - Fields:

    1) **Profile**

       - Name: `Profile`
       - Value (multi-line string), for example:

         ```text
         Discord: <@USER_ID> (or username)
         Tier: Mythic / Legendary / Rare / Unranked
         Total queries: 0
         Member since: YYYY-MM-DD
         ```

    2) **Wallets**

       - Name: `Wallets`
       - If `wallets.length === 0`:
         Value: `"No wallets linked yet. Use the buttons below to add and verify a wallet."`
       - Else:
         - Show up to the first 5 wallets in a compact format:
           `"1) 0x1234…abcd (dfk-chain) – Verified"`
           `"2) 0x9876…cdef (cv) – Not verified"`
         - If more than 5 wallets, add a note: `"+ X more wallets"`

    3) **LP Positions**

       - Name: `LP Positions`
       - If `lpPositions.length === 0`:
         Value: `"No LP positions detected yet. Hedge will show your gardens and LPs here."`
       - Else:
         - For each LP (limit to 3–5 entries to avoid spam), format like:

           ```text
           CRYSTAL-JEWEL (dfk-chain)
           • 12.34 LP
           • 24h APR (with quests): 45.6%
           ```

       - Very important: in comments and naming, make it clear that `apr24h` is intended to represent:
         `"current 24h effective APR including base garden rewards plus questing rewards."`
         For now it's placeholder data; later we will wire it to real DFK calculations.

  - Footer:
    - Text like: `"Early Access – features and on-chain automation are still being rolled out."`

- The reply should be:

  ```js
  await interaction.reply({
    embeds: [embed],
    components: [rowWallets, rowLpActions, rowRequests, ...],
    ephemeral: true,
  });
